/***************************************************************************/ /**
   @file     +Nombre del archivo (ej: template.c)+
   @brief    +Descripcion del archivo+
   @author   +Nombre del autor (ej: Salvador Allende)+
  ******************************************************************************/

/*******************************************************************************
 * INCLUDE HEADER FILES
 ******************************************************************************/
#include "eventQueue.h"
#include <stdlib.h>
#include <stdint.h>
/*******************************************************************************
 * CONSTANT AND MACRO DEFINITIONS USING #DEFINE
 ******************************************************************************/
#define EVENT_BUFFER_SIZE 64
/*******************************************************************************
 * ENUMERATIONS AND STRUCTURES AND TYPEDEFS
 ******************************************************************************/

/*******************************************************************************
 * VARIABLES WITH GLOBAL SCOPE
 ******************************************************************************/

/*******************************************************************************
 * FUNCTION PROTOTYPES FOR PRIVATE FUNCTIONS WITH FILE LEVEL SCOPE
 ******************************************************************************/

/*******************************************************************************
 * ROM CONST VARIABLES WITH FILE LEVEL SCOPE
 ******************************************************************************/

/*******************************************************************************
 * STATIC VARIABLES AND CONST VARIABLES WITH FILE LEVEL SCOPE
 ******************************************************************************/
static event_t buffer[EVENT_BUFFER_SIZE + 1] = {0};
uint32_t head = 0;
uint32_t tail = 0;
/*******************************************************************************
 *******************************************************************************
                        GLOBAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/
event_t getNextEvent(void)
{
    if (tail == head)
        return None;

    event_t aux_event = buffer[head];
    head = (head == EVENT_BUFFER_SIZE - 1) ? 0 : head + 1;
    return aux_event;
}

event_t popEvent(void)
{
    if (tail == head)
        return None;

    tail = (tail == 0) ? EVENT_BUFFER_SIZE - 1 : tail - 1;
    return buffer[tail];
}

void putEvent(event_t evnt)
{

    buffer[tail] = evnt;
    tail = (tail == EVENT_BUFFER_SIZE - 1) ? 0 : tail + 1;
    if (tail == head)
    {
        head = (head == EVENT_BUFFER_SIZE - 1) ? 0 : head + 1;
    }
}
/*******************************************************************************
 *******************************************************************************
                        LOCAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/

